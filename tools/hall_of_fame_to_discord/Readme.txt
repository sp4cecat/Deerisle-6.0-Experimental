================================================================================
          DAYZ DEER ISLE SPEEDRUN TRACKER - DISCORD BOT
                   INSTALLATION & USAGE MANUAL
================================================================================

Version: 1.1
Language: PowerShell (Windows)
Filename: deerisle_halloffame_to_discord.ps1

[ TABLE OF CONTENTS ]
--------------------------------------------------------------------------------
1. OVERVIEW
2. PREREQUISITES
3. INSTALLATION
4. CONFIGURATION
5. MANUAL TESTING
6. AUTOMATION (TASK SCHEDULER)
7. TROUBLESHOOTING

================================================================================
1. OVERVIEW
================================================================================
This tool reads the `halloffame.json` file generated by your DayZ Deer Isle
server and posts a formatted "Speedrun Leaderboard" to a specific Discord
channel.

Features:
- Speedrun Logic: Sorts by Discovery Progress (High%) first, then Time (Fastest).
- Pagination: Automatically splits long lists into pages (10 players per post).
- Safety: Sends a "No entries yet" challenge message if the file is empty/missing.
- Stability: Uses Unicode bytes to ensure Emojis work on all Windows versions.

================================================================================
2. PREREQUISITES
================================================================================
1. OS: Windows Server 2016/2019/2022 or Windows 10/11.
2. PowerShell: Version 5.1 or newer (Standard on Windows).
3. Data Source: A valid `halloffame.json` file generated by your server mod.
4. Discord: A Webhook URL for the channel where you want the stats posted.

   -> HOW TO GET A WEBHOOK URL:
   1. Open Discord -> Right-click your channel -> "Edit Channel".
   2. Go to "Integrations" -> "Webhooks".
   3. Click "New Webhook", name it (e.g., "Deer Isle Bot").
   4. Click "Copy Webhook URL".

================================================================================
3. INSTALLATION
================================================================================
1. Open a text editor (Notepad, Notepad++, VS Code).
2. Copy the final PowerShell script code provided in the chat.
3. Save the file with the exact name:
   
   deerisle_halloffame_to_discord.ps1

   Recommended Path example:
   D:\SteamLibrary\steamapps\common\DayZ\deerisle_halloffame_to_discord.ps1

================================================================================
4. CONFIGURATION
================================================================================
Before running the script, you must edit the top section of the .ps1 file.

1. Right-click `deerisle_halloffame_to_discord.ps1` -> "Edit".
2. Locate the "CONFIGURATION" block at the very top.

   $jsonPath   = "D:\Path\To\Your\mpmissions\...\halloffame.json"
   $webhookUrl = "https://discord.com/api/webhooks/..."

3. Update `$jsonPath`:
   Ensure this points exactly to where your server saves the JSON file.

4. Update `$webhookUrl`:
   Paste the URL you copied from Discord in Step 2.

5. Save the file.

================================================================================
5. MANUAL TESTING
================================================================================
It is highly recommended to run the script manually once to ensure it works.

1. Press `Windows Key`, type "PowerShell", and press Enter.
2. Navigate to your folder (adjust path if needed):
   cd "D:\SteamLibrary\steamapps\common\DayZ\"

3. Run the script with the execution policy bypass (prevents permission errors):
   PowerShell.exe -ExecutionPolicy Bypass -File .\deerisle_halloffame_to_discord.ps1

4. Check the Console Output:
   - Green text: "Done! All pages sent successfully."
   - Yellow text: "File missing... Sending Challenge..." (If no players yet)
   - Red text: Error details (Check Troubleshooting section).

5. Check Discord:
   You should see the leaderboard or the "No entries found" message.

================================================================================
6. AUTOMATION (WINDOWS TASK SCHEDULER)
================================================================================
To make the bot post automatically (e.g., every day), follow these steps:

1. Press `Win + R`, type `taskschd.msc`, and hit Enter.
2. In the right-hand menu, click "Create Basic Task...".
3. Name: "DayZ Speedrun Bot". Click Next.
4. Trigger: Select "Daily" (or your preferred frequency). Click Next.
5. Action: Select "Start a program". Click Next.

6. Configure the Program (CRITICAL STEP):
   
   - Program/script:
     PowerShell.exe

   - Add arguments (optional):
     -ExecutionPolicy Bypass -File "D:\SteamLibrary\steamapps\common\DayZ\deerisle_halloffame_to_discord.ps1"
     *(Make sure the path matches where you saved the file)*

   - Start in (optional):
     D:\SteamLibrary\steamapps\common\DayZ\
     *(The folder where the script is located, no quotes needed here)*

7. Click Next, then Finish.

Test the Automation:
Right-click your new task in the list and select "Run". Check Discord.

================================================================================
7. TROUBLESHOOTING
================================================================================

[ERROR] "File not found"
-> Check the `$jsonPath` in the script. It must include the filename `.json`.

[ERROR] "Execution of scripts is disabled on this system"
-> Ensure you are using `-ExecutionPolicy Bypass` in your command line or Task
   Scheduler arguments.

[ISSUE] "???" instead of Emojis in the Black Console Window
-> Ignore this. The Windows Console often cannot display Emojis.
   Check Discord; if they look correct there, everything is fine.

[ISSUE] Discord messages are not appearing
-> Check your Webhook URL. If you deleted the webhook in Discord, you must
   generate a new one and update the script.
-> The script includes a 1-second pause between messages to prevent Discord
   from blocking the bot (Rate Limiting). Do not remove this pause.

================================================================================